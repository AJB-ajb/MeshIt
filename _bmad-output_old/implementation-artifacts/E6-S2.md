# Story 6.2: Create Notification Service

**Epic:** E6 - Notifications  
**Status:** ready-for-dev  
**Priority:** P1  
**Dependencies:** 6.1  
**Blocks:** 6.3, 6.4, 6.5, 6.6

## Story

As a developer,
I want a notification service for CRUD operations,
so that I can create and manage notifications.

## Acceptance Criteria

1. **Given** a notification event (new match, message)
   **When** I call createNotification()
   **Then** a notification record is created in the database

2. **Given** a user's notifications
   **When** I call getNotifications()
   **Then** I get their notifications sorted by date

3. **Given** a notification
   **When** I call markAsRead()
   **Then** the read_at timestamp is set

4. **Given** a user
   **When** I call getUnreadCount()
   **Then** I get the count of unread notifications

## Tasks / Subtasks

- [ ] Task 1: Create notification types (AC: #1)
  - [ ] Create `src/lib/notifications/types.ts`
  - [ ] Define notification types: 'new_match', 'new_message', 'project_expired'

- [ ] Task 2: Create notification service (AC: #1, #2, #3, #4)
  - [ ] Create `src/lib/notifications/service.ts`
  - [ ] Implement createNotification
  - [ ] Implement getNotifications
  - [ ] Implement markAsRead
  - [ ] Implement getUnreadCount

- [ ] Task 3: Create API routes
  - [ ] GET /api/notifications
  - [ ] PATCH /api/notifications/[id]/read
  - [ ] GET /api/notifications/unread-count

## Dev Notes

- Notification types determine icon and action
- Consider batch marking as read
- Unread count used for badge display

### Code Structure

```typescript
// src/lib/notifications/types.ts
export type NotificationType = 'new_match' | 'new_message' | 'project_expired';

export interface Notification {
  id: string;
  user_id: string;
  type: NotificationType;
  title: string;
  message: string;
  link?: string;
  read_at?: string;
  created_at: string;
}

// src/lib/notifications/service.ts
export async function createNotification(
  userId: string,
  type: NotificationType,
  title: string,
  message: string,
  link?: string
): Promise<Notification>

export async function getNotifications(userId: string): Promise<Notification[]>
export async function markAsRead(notificationId: string): Promise<void>
export async function getUnreadCount(userId: string): Promise<number>
```

### References

- [Source: planning-artifacts/architecture.md#Notifications Table]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
