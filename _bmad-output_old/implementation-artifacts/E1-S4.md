# Story 1.4: Run Database Schema

**Epic:** E1 - Foundation  
**Status:** ready-for-dev  
**Priority:** P0  
**Dependencies:** 1.3  
**Blocks:** E3, E4, E5, E6, E7

## Story

As a developer,
I want all database tables created with RLS policies,
so that the data layer is ready for the application.

## Acceptance Criteria

1. **Given** the Supabase project with pgvector enabled
   **When** I run the schema SQL
   **Then** all tables are created: profiles, projects, matches, messages, notifications, github_profiles

2. **Given** the tables exist
   **When** I check RLS policies
   **Then** all tables have RLS enabled
   **And** appropriate policies exist for each table

3. **Given** the schema
   **When** I check indexes
   **Then** pgvector indexes exist on embedding columns
   **And** performance indexes exist on foreign keys

4. **Given** the schema
   **When** I check functions
   **Then** match_users_to_project function exists
   **And** match_projects_to_user function exists
   **And** auto-expire function exists

## Tasks / Subtasks

- [ ] Task 1: Run core schema (AC: #1)
  - [ ] Open Supabase SQL Editor
  - [ ] Run profiles table creation
  - [ ] Run projects table creation
  - [ ] Run matches table creation
  - [ ] Run messages table creation
  - [ ] Run notifications table creation
  - [ ] Run github_profiles table creation

- [ ] Task 2: Enable RLS and create policies (AC: #2)
  - [ ] Enable RLS on all tables
  - [ ] Create profile policies
  - [ ] Create project policies
  - [ ] Create match policies
  - [ ] Create message policies
  - [ ] Create notification policies
  - [ ] Create github_profiles policies

- [ ] Task 3: Create indexes (AC: #3)
  - [ ] Create pgvector indexes on profiles.embedding
  - [ ] Create pgvector indexes on projects.embedding
  - [ ] Create indexes on foreign keys

- [ ] Task 4: Create functions and triggers (AC: #4)
  - [ ] Create match_users_to_project function
  - [ ] Create match_projects_to_user function
  - [ ] Create expire_old_projects function
  - [ ] Create handle_new_user trigger
  - [ ] Create notification triggers

## Dev Notes

- Full schema SQL is in architecture.md Section 4
- Run in order: extensions → tables → indexes → RLS → functions → triggers
- Test RLS policies after creation

### Project Structure Notes

Schema creates these tables:
- `profiles` - User profiles with embeddings
- `projects` - Project listings with embeddings
- `matches` - Match records between profiles and projects
- `messages` - Chat messages
- `notifications` - In-app notifications
- `github_profiles` - GitHub extracted data

### References

- [Source: planning-artifacts/architecture.md#4. Database Schema]
- [Source: planning-artifacts/architecture.md#RLS Policies]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
