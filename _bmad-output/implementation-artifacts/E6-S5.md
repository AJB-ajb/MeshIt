# Story 6.5: Implement Email Notifications

**Epic:** E6 - Notifications  
**Status:** ready-for-dev  
**Priority:** P1  
**Dependencies:** 6.2  
**Blocks:** None

## Story

As a user,
I want email notifications for important events,
so that I don't miss matches or messages when offline.

## Acceptance Criteria

1. **Given** a new match is created
   **When** the user has email notifications enabled
   **Then** they receive an email about the match

2. **Given** a new message is received
   **When** the user has email notifications enabled
   **Then** they receive an email about the message

3. **Given** the email
   **When** I read it
   **Then** it has clear subject, preview, and CTA to view in app

4. **Given** email sending fails
   **When** the error occurs
   **Then** it is logged but doesn't break the main flow

## Tasks / Subtasks

- [ ] Task 1: Set up Resend client (AC: #1, #2)
  - [ ] Install `resend` package
  - [ ] Create `src/lib/email/client.ts`
  - [ ] Configure with API key

- [ ] Task 2: Create email templates (AC: #3)
  - [ ] Create `src/lib/email/templates/new-match.tsx`
  - [ ] Create `src/lib/email/templates/new-message.tsx`
  - [ ] Use React Email for templates

- [ ] Task 3: Create email service (AC: #1, #2, #4)
  - [ ] Create `src/lib/email/service.ts`
  - [ ] Implement sendMatchEmail
  - [ ] Implement sendMessageEmail
  - [ ] Handle errors gracefully

- [ ] Task 4: Integrate with notification creation
  - [ ] Call email service when notification created
  - [ ] Check user's email preferences

## Dev Notes

- Resend provides React Email support
- Use environment variable for from address
- Consider rate limiting for email sends

### Code Structure

```typescript
// src/lib/email/service.ts
import { Resend } from 'resend';

const resend = new Resend(process.env.RESEND_API_KEY);

export async function sendMatchEmail(
  to: string,
  matchData: { projectTitle: string; score: number; link: string }
): Promise<void>

export async function sendMessageEmail(
  to: string,
  messageData: { senderName: string; preview: string; link: string }
): Promise<void>
```

### Email Template Example

```
Subject: New Match! AI Startup MVP (92%)

Hi John,

Great news! You've matched 92% with "AI Startup MVP".

They're looking for React and TypeScript developers 
for a part-time commitment.

[View Match â†’]

---
MeshIt - Find your perfect project match
```

### References

- [Source: planning-artifacts/architecture.md#Email Notifications]
- [Source: planning-artifacts/prd.md#FR21 Email Notifications]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
