# Story 5.6: Generate Match Explanations

**Epic:** E5 - Matching Engine  
**Status:** ready-for-dev  
**Priority:** P1  
**Dependencies:** 5.1, 5.2  
**Blocks:** None

## Story

As a system,
I want to generate text explanations for matches,
so that users understand why they were matched.

## Acceptance Criteria

1. **Given** a match between profile and project
   **When** I call generateMatchExplanation()
   **Then** I get a 2-3 sentence explanation

2. **Given** the explanation
   **When** I read it
   **Then** it mentions specific skill overlaps
   **And** it mentions availability/commitment alignment

3. **Given** match creation
   **When** a new match is saved
   **Then** explanation is generated and stored

4. **Given** API rate limits
   **When** explanation generation fails
   **Then** the match is still saved without explanation

## Tasks / Subtasks

- [ ] Task 1: Create explanation generator (AC: #1, #2)
  - [ ] Create `src/lib/matching/explanation.ts`
  - [ ] Use Gemini to generate explanation
  - [ ] Pass profile and project data as context

- [ ] Task 2: Integrate with match creation (AC: #3, #4)
  - [ ] Call generator when match is created
  - [ ] Store in matches.explanation column
  - [ ] Handle errors gracefully

## Dev Notes

- Use Gemini Flash for cost efficiency
- Keep explanations concise (2-3 sentences)
- Consider generating explanations in batch

### Code Structure

```typescript
// src/lib/matching/explanation.ts
export async function generateMatchExplanation(
  profile: Profile,
  project: Project,
  score: number
): Promise<string>
```

### Prompt Template

```
Given this user profile and project, explain in 2-3 sentences why they are a good match.

Profile:
- Skills: {skills}
- Experience: {experience_level}
- Availability: {availability_hours} hrs/week
- Interests: {interests}

Project:
- Title: {title}
- Description: {description}
- Skills Needed: {skills_needed}
- Commitment: {commitment_level}

Match Score: {score}%

Explanation:
```

### References

- [Source: planning-artifacts/architecture.md#Match Explanation Generation]
- [Source: planning-artifacts/prd.md#FR16 Match Explanation]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
