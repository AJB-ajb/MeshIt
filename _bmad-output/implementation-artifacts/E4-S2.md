# Story 4.2: Create Project CRUD API Routes

**Epic:** E4 - Project Management  
**Status:** ready-for-dev  
**Priority:** P0  
**Dependencies:** E1-S4, E1-S10  
**Blocks:** 4.3, 4.4, 4.5

## Story

As a frontend,
I want API endpoints for project CRUD operations,
so that I can create, read, update, and delete projects.

## Acceptance Criteria

1. **Given** a GET request to /api/projects
   **When** user is authenticated
   **Then** their projects are returned (as owner)

2. **Given** a GET request to /api/projects/[id]
   **When** project exists
   **Then** project details are returned

3. **Given** a POST request with project data
   **When** user is authenticated
   **Then** a new project is created
   **And** expires_at is set to 30 days from now

4. **Given** a PUT request to /api/projects/[id]
   **When** user owns the project
   **Then** the project is updated

5. **Given** a DELETE request to /api/projects/[id]
   **When** user owns the project
   **Then** the project is soft-deleted (status = 'closed')

## Tasks / Subtasks

- [ ] Task 1: Create GET /api/projects (AC: #1)
  - [ ] Create `src/app/api/projects/route.ts`
  - [ ] Query projects where owner_id = user.id
  - [ ] Return array of projects

- [ ] Task 2: Create POST /api/projects (AC: #3)
  - [ ] Accept project data in body
  - [ ] Set owner_id to current user
  - [ ] Set expires_at to now + 30 days
  - [ ] Return created project

- [ ] Task 3: Create GET /api/projects/[id] (AC: #2)
  - [ ] Create `src/app/api/projects/[id]/route.ts`
  - [ ] Query project by ID
  - [ ] Return 404 if not found

- [ ] Task 4: Create PUT /api/projects/[id] (AC: #4)
  - [ ] Verify ownership
  - [ ] Update project fields
  - [ ] Return updated project

- [ ] Task 5: Create DELETE /api/projects/[id] (AC: #5)
  - [ ] Verify ownership
  - [ ] Set status to 'closed'
  - [ ] Return success

## Dev Notes

- RLS policies handle ownership checks at DB level
- expires_at is auto-set on creation
- Consider pagination for GET /api/projects

### API Specification

```typescript
// GET /api/projects
// Response 200
{ projects: Project[] }

// POST /api/projects
// Request
{
  title: string;
  description: string;
  skills_needed: string[];
  commitment_level: string;
  project_stage: string;
}

// GET /api/projects/[id]
// Response 200
{ project: Project }

// PUT /api/projects/[id]
// Request (partial update)
{
  title?: string;
  description?: string;
  // ...
}

// DELETE /api/projects/[id]
// Response 200
{ success: true }
```

### References

- [Source: planning-artifacts/architecture.md#API Routes Specification]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
