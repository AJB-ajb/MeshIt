# Story 2.5: Store GitHub Profile Data

**Epic:** E2 - GitHub Enrichment  
**Status:** ready-for-dev  
**Priority:** P1  
**Dependencies:** E1-S4 (DB schema)  
**Blocks:** 2.6

## Story

As a system,
I want GitHub profile data stored in the database,
so that it persists and can be refreshed later.

## Acceptance Criteria

1. **Given** extracted GitHub data
   **When** I save to the database
   **Then** github_profiles table is populated
   **And** user_id links to profiles table

2. **Given** saved GitHub data
   **When** I query for a user
   **Then** I can retrieve their GitHub profile
   **And** last_synced_at shows when data was fetched

3. **Given** a user syncs again
   **When** new data is saved
   **Then** existing record is updated (upsert)
   **And** last_synced_at is refreshed

## Tasks / Subtasks

- [ ] Task 1: Create GitHub profile service (AC: #1, #2, #3)
  - [ ] Create `src/lib/github/db.ts`
  - [ ] Implement saveGitHubProfile function
  - [ ] Implement getGitHubProfile function
  - [ ] Use upsert for save operation

- [ ] Task 2: Add TypeScript types
  - [ ] Create database types for github_profiles
  - [ ] Ensure type safety with Supabase

## Dev Notes

- Use Supabase upsert to handle both insert and update
- Store raw_repos as JSONB for future analysis
- last_synced_at helps determine if refresh needed

### Code Structure

```typescript
// src/lib/github/db.ts
export async function saveGitHubProfile(
  userId: string,
  data: GitHubProfileData & { githubUsername: string; githubId: string }
): Promise<void>

export async function getGitHubProfile(
  userId: string
): Promise<GitHubProfileData | null>
```

### References

- [Source: planning-artifacts/architecture.md#Database Schema - github_profiles]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
