# Story 4.1: Implement Project Extraction Service

**Epic:** E4 - Project Management  
**Status:** ready-for-dev  
**Priority:** P0  
**Dependencies:** 3.1 (Gemini service)  
**Blocks:** 4.3

## Story

As a developer,
I want a Gemini service that extracts structured data from project descriptions,
so that I can parse natural language project posts.

## Acceptance Criteria

1. **Given** a text description like "Looking for a frontend dev for my AI startup..."
   **When** I call extractProject()
   **Then** I get structured JSON with title, description, skills_needed, commitment_level, project_stage

2. **Given** incomplete information in the text
   **When** I call extractProject()
   **Then** reasonable defaults are used for missing fields
   **And** the extraction doesn't fail

3. **Given** edge cases or malformed input
   **When** I call extractProject()
   **Then** the service returns a valid structure
   **And** errors are handled gracefully

## Tasks / Subtasks

- [ ] Task 1: Create project extraction prompts (AC: #1, #2)
  - [ ] Create `src/lib/ai/prompts/project-extraction.ts`
  - [ ] Define structured output schema with Zod
  - [ ] Write extraction prompt template

- [ ] Task 2: Implement extraction function (AC: #1, #2, #3)
  - [ ] Add extractProject to `src/lib/ai/extraction.ts`
  - [ ] Use StructuredOutputParser from LangChain
  - [ ] Handle parsing errors
  - [ ] Add fallback defaults

## Dev Notes

- Reuse Gemini client from 3.1
- Project schema is different from profile schema
- Consider inferring project_stage from language used

### Code Structure

```typescript
// src/lib/ai/types.ts
export interface StructuredProject {
  title: string;
  description: string;
  skills_needed: string[];
  commitment_level: 'part-time' | 'full-time' | 'flexible';
  project_stage: 'idea' | 'mvp' | 'growth' | 'established';
}

// src/lib/ai/extraction.ts
export async function extractProject(description: string): Promise<StructuredProject>
```

### References

- [Source: planning-artifacts/architecture.md#5. AI Service Interface]
- [Source: planning-artifacts/architecture.md#Project Extraction]

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List
